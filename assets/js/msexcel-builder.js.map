{
  "version": 3,
  "file": "msexcel-builder.js",
  "sourceRoot": "../src",
  "sources": [
    "msexcel-builder.coffee"
  ],
  "names": [],
  "mappings": ";AAAA;EAAA;;;;;AAAA,MAAA,YAAA,EAAA,WAAA,EAAA,aAAA,EAAA,KAAA,EAAA,aAAA,EAAA,KAAA,EAAA,KAAA,EAAA,QAAA,EAAA,MAAA,EAAA,UAAA,EAAA,MAAA,EAAA,IAAA,EAAA;;EAKA,IAAI,kDAAA,IAAW,sBAAf;IACE,KAAA,GAAQ,MAAM,CAAC,MADjB;GAAA,MAEK,IAAI,OAAO,OAAP,KAAkB,WAAtB;IACH,KAAA,GAAQ,OAAA,CAAQ,OAAR,EADL;GAAA,MAAA;IAGH,MAAO,oBAHJ;;;EAKL,IAAI,kDAAA,IAAW,2BAAf;IACE,GAAA,GAAM,MAAM,CAAC,WADf;GAAA,MAEK,IAAI,OAAO,OAAP,KAAkB,WAAtB;IACH,GAAA,GAAM,OAAA,CAAQ,YAAR,EADH;GAAA,MAAA;IAGH,MAAO,yBAHJ;GAdL;;;;;EAuBA,IAAA,GACE;IAAA,GAAA,EAAK,QAAA,CAAC,MAAD,CAAA;AACH,UAAA,MAAA,EAAA;MAAA,IAAA,GAAO;MACP,MAAA,GAAS;AACT,aAAM,MAAA,GAAS,CAAf;QACE,IAAA,GAAO,CAAC,MAAA,GAAS,CAAV,CAAA,GAAe;QACtB,MAAA,GAAS,MAAM,CAAC,YAAP,CAAoB,IAAA,GAAO,EAA3B,CAAA,GAAiC;QAC1C,MAAA,GAAS,CAAC,MAAA,GAAS,IAAT,GAAgB,CAAjB,CAAA,GAAsB;MAHjC;AAIA,aAAO;IAPJ;EAAL;;EAUI,eAAN,MAAA,aAAA;IACE,WAAa,KAAA,CAAA;MAAC,IAAC,CAAA;IAAF;;IAEb,KAAM,CAAA,CAAA;AACJ,UAAA,CAAA,EAAA,CAAA,EAAA,GAAA,EAAA;MAAA,KAAA,GAAQ,GAAG,CAAC,MAAJ,CAAW,OAAX,EAAmB;QAAC,OAAA,EAAQ,KAAT;QAAe,QAAA,EAAS,OAAxB;QAAgC,UAAA,EAAW;MAA3C,CAAnB;MACR,KAAK,CAAC,GAAN,CAAU,OAAV,EAAkB,8DAAlB;MACA,KAAK,CAAC,GAAN,CAAU,UAAV,EAAqB;QAAC,QAAA,EAAS,sBAAV;QAAiC,WAAA,EAAY;MAA7C,CAArB;MACA,KAAK,CAAC,GAAN,CAAU,UAAV,EAAqB;QAAC,QAAA,EAAS,gBAAV;QAA2B,WAAA,EAAY;MAAvC,CAArB;MACA,KAAK,CAAC,GAAN,CAAU,SAAV,EAAoB;QAAC,SAAA,EAAU,MAAX;QAAkB,WAAA,EAAY;MAA9B,CAApB;MACA,KAAK,CAAC,GAAN,CAAU,SAAV,EAAoB;QAAC,SAAA,EAAU,KAAX;QAAiB,WAAA,EAAY;MAA7B,CAApB;MACA,KAAK,CAAC,GAAN,CAAU,UAAV,EAAqB;QAAC,QAAA,EAAS,kBAAV;QAA6B,WAAA,EAAY;MAAzC,CAArB;MACA,KAAK,CAAC,GAAN,CAAU,UAAV,EAAqB;QAAC,QAAA,EAAS,mBAAV;QAA8B,WAAA,EAAY;MAA1C,CAArB;MACA,KAAS,kGAAT;QACE,KAAK,CAAC,GAAN,CAAU,UAAV,EAAqB;UAAC,QAAA,EAAS,sBAAA,GAAuB,CAAvB,GAAyB,MAAnC;UAA0C,WAAA,EAAY;QAAtD,CAArB;MADF;MAEA,KAAK,CAAC,GAAN,CAAU,UAAV,EAAqB;QAAC,QAAA,EAAS,uBAAV;QAAkC,WAAA,EAAY;MAA9C,CAArB;MACA,KAAK,CAAC,GAAN,CAAU,UAAV,EAAqB;QAAC,QAAA,EAAS,oBAAV;QAA+B,WAAA,EAAY;MAA3C,CAArB;AACA,aAAO,KAAK,CAAC,GAAN,CAAA;IAbH;;EAHR;;EAkBM,cAAN,MAAA,YAAA;IACE,WAAa,KAAA,CAAA;MAAC,IAAC,CAAA;IAAF;;IAEb,KAAO,CAAA,CAAA;AACL,UAAA,CAAA,EAAA,CAAA,EAAA,KAAA,EAAA,GAAA,EAAA;MAAA,KAAA,GAAQ,GAAG,CAAC,MAAJ,CAAW,YAAX,EAAwB;QAAC,OAAA,EAAQ,KAAT;QAAe,QAAA,EAAS,OAAxB;QAAgC,UAAA,EAAW;MAA3C,CAAxB;MACR,KAAK,CAAC,GAAN,CAAU,OAAV,EAAkB,2EAAlB;MACA,KAAK,CAAC,GAAN,CAAU,UAAV,EAAqB,sEAArB;MACA,KAAK,CAAC,GAAN,CAAU,aAAV,EAAwB,iBAAxB;MACA,KAAK,CAAC,GAAN,CAAU,aAAV,EAAwB,GAAxB;MACA,KAAK,CAAC,GAAN,CAAU,WAAV,EAAsB,OAAtB;MACA,GAAA,GAAM,KAAK,CAAC,GAAN,CAAU,cAAV,CAAyB,CAAC,GAA1B,CAA8B,WAA9B,EAA0C;QAAC,IAAA,EAAK,CAAN;QAAQ,QAAA,EAAS;MAAjB,CAA1C;MACN,GAAG,CAAC,GAAJ,CAAQ,YAAR,CAAqB,CAAC,GAAtB,CAA0B,UAA1B,EAAqC,KAArC;MACA,GAAG,CAAC,GAAJ,CAAQ,YAAR,CAAqB,CAAC,GAAtB,CAA0B,OAA1B,EAAkC,EAAA,GAAG,IAAC,CAAA,IAAI,CAAC,MAAM,CAAC,MAAlD;MACA,GAAA,GAAM,KAAK,CAAC,GAAN,CAAU,eAAV,CAA0B,CAAC,GAA3B,CAA+B,WAA/B,EAA2C;QAAC,IAAA,EAAK,IAAC,CAAA,IAAI,CAAC,MAAM,CAAC,MAAnB;QAA0B,QAAA,EAAS;MAAnC,CAA3C;MACN,KAAS,kGAAT;QACE,GAAG,CAAC,GAAJ,CAAQ,UAAR,EAAmB,IAAC,CAAA,IAAI,CAAC,MAAO,CAAA,CAAA,GAAE,CAAF,CAAI,CAAC,IAArC;MADF;MAEA,KAAK,CAAC,GAAN,CAAU,SAAV;MACA,KAAK,CAAC,GAAN,CAAU,eAAV,EAA0B,OAA1B;MACA,KAAK,CAAC,GAAN,CAAU,WAAV,EAAsB,OAAtB;MACA,KAAK,CAAC,GAAN,CAAU,mBAAV,EAA8B,OAA9B;MACA,KAAK,CAAC,GAAN,CAAU,YAAV,EAAuB,SAAvB;AACA,aAAO,KAAK,CAAC,GAAN,CAAA;IAlBF;;EAHT;;EAuBM,aAAN,MAAA,WAAA;IACE,WAAa,KAAA,CAAA;MAAC,IAAC,CAAA;IAAF;;IAEb,KAAO,CAAA,CAAA;AACL,UAAA,YAAA,EAAA,CAAA,EAAA,CAAA,EAAA,GAAA,EAAA,GAAA,EAAA;MAAA,EAAA,GAAK,GAAG,CAAC,MAAJ,CAAW,UAAX,EAAsB;QAAC,OAAA,EAAQ,KAAT;QAAe,QAAA,EAAS,OAAxB;QAAgC,UAAA,EAAW;MAA3C,CAAtB;MACL,EAAE,CAAC,GAAH,CAAO,OAAP,EAAe,2DAAf;MACA,EAAE,CAAC,GAAH,CAAO,SAAP,EAAiB,qEAAjB;MACA,EAAE,CAAC,GAAH,CAAO,cAAP,EAAsB;QAAC,OAAA,EAAQ,IAAT;QAAc,UAAA,EAAW,GAAzB;QAA6B,YAAA,EAAa,GAA1C;QAA8C,QAAA,EAAS;MAAvD,CAAtB;MACA,EAAE,CAAC,GAAH,CAAO,YAAP,EAAoB;QAAC,aAAA,EAAc,GAAf;QAAmB,mBAAA,EAAoB;MAAvC,CAApB;MACA,EAAE,CAAC,GAAH,CAAO,WAAP,CAAmB,CAAC,GAApB,CAAwB,eAAxB,EAAwC;QAAC,OAAA,EAAQ,GAAT;QAAa,OAAA,EAAQ,IAArB;QAA0B,WAAA,EAAY,OAAtC;QAA8C,YAAA,EAAa;MAA3D,CAAxC;MACA,GAAA,GAAM,EAAE,CAAC,GAAH,CAAO,QAAP;MACN,KAAS,kGAAT;QACE,GAAG,CAAC,GAAJ,CAAQ,OAAR,EAAgB;UAAC,IAAA,EAAK,IAAC,CAAA,IAAI,CAAC,MAAO,CAAA,CAAA,GAAE,CAAF,CAAI,CAAC,IAAxB;UAA6B,OAAA,EAAQ,EAAA,GAAG,CAAxC;UAA0C,MAAA,EAAO,KAAA,GAAM;QAAvD,CAAhB;MADF;MAIA,YAAA,GAAe,EAAE,CAAC,GAAH,CAAO,cAAP,EAXf;MAYA,IAAC,CAAA,IAAI,CAAC,MAAM,CAAC,OAAb,CAAqB,QAAA,CAAC,KAAD,EAAQ,GAAR,CAAA;QACnB,IAAI,KAAK,CAAC,UAAV;iBACE,YAAY,CAAC,GAAb,CAAiB,aAAjB,EAAgC;YAAC,IAAA,EAAM,uBAAP;YAAgC,MAAA,EAAQ,GAAxC;YAA6C,YAAA,EAAc;UAA3D,CAAhC,CAAgG,CAAC,GAAjG,CAAqG,GAAA,GAAI,KAAK,CAAC,IAAV,GAAiB,IAAjB,GAAyB,KAAK,CAAC,QAAN,CAAA,CAA9H,EADF;;MADmB,CAArB;MAIA,EAAE,CAAC,GAAH,CAAO,QAAP,EAAgB;QAAC,MAAA,EAAO;MAAR,CAAhB;AACA,aAAO,EAAE,CAAC,GAAH,CAAA;IAlBF;;EAHT;;EAuBM,SAAN,MAAA,OAAA;IACE,WAAa,KAAA,CAAA;MAAC,IAAC,CAAA;IAAF;;IAEb,KAAO,CAAA,CAAA;AACL,UAAA,CAAA,EAAA,CAAA,EAAA,GAAA,EAAA;MAAA,EAAA,GAAK,GAAG,CAAC,MAAJ,CAAW,eAAX,EAA2B;QAAC,OAAA,EAAQ,KAAT;QAAe,QAAA,EAAS,OAAxB;QAAgC,UAAA,EAAW;MAA3C,CAA3B;MACL,EAAE,CAAC,GAAH,CAAO,OAAP,EAAe,8DAAf;MACA,KAAS,kGAAT;QACE,EAAE,CAAC,GAAH,CAAO,cAAP,EAAsB;UAAC,EAAA,EAAG,KAAA,GAAM,CAAV;UAAY,IAAA,EAAK,+EAAjB;UAAiG,MAAA,EAAO,kBAAA,GAAmB,CAAnB,GAAqB;QAA7H,CAAtB;MADF;MAEA,EAAE,CAAC,GAAH,CAAO,cAAP,EAAsB;QAAC,EAAA,EAAG,KAAA,GAAM,CAAC,IAAC,CAAA,IAAI,CAAC,MAAM,CAAC,MAAb,GAAoB,CAArB,CAAV;QAAkC,IAAA,EAAK,2EAAvC;QAAmH,MAAA,EAAO;MAA1H,CAAtB;MACA,EAAE,CAAC,GAAH,CAAO,cAAP,EAAsB;QAAC,EAAA,EAAG,KAAA,GAAM,CAAC,IAAC,CAAA,IAAI,CAAC,MAAM,CAAC,MAAb,GAAoB,CAArB,CAAV;QAAkC,IAAA,EAAK,4EAAvC;QAAoH,MAAA,EAAO;MAA3H,CAAtB;MACA,EAAE,CAAC,GAAH,CAAO,cAAP,EAAsB;QAAC,EAAA,EAAG,KAAA,GAAM,CAAC,IAAC,CAAA,IAAI,CAAC,MAAM,CAAC,MAAb,GAAoB,CAArB,CAAV;QAAkC,IAAA,EAAK,mFAAvC;QAA2H,MAAA,EAAO;MAAlI,CAAtB;AACA,aAAO,EAAE,CAAC,GAAH,CAAA;IARF;;EAHT;;EAaM,gBAAN,MAAA,cAAA;IACE,WAAa,CAAA,CAAA;MACX,IAAC,CAAA,KAAD,GAAS,CAAA;MACT,IAAC,CAAA,GAAD,GAAO;IAFI;;IAIb,MAAQ,CAAC,CAAD,CAAA;AACN,UAAA;MAAA,EAAA,GAAK,IAAC,CAAA,KAAM,CAAA,CAAA;MACZ,IAAG,EAAH;AACE,eAAO,GADT;OAAA,MAAA;QAGE,IAAC,CAAA,GAAG,CAAC,IAAL,CAAU,CAAV;QACA,IAAC,CAAA,KAAM,CAAA,CAAA,CAAP,GAAY,IAAC,CAAA,GAAG,CAAC;AACjB,eAAO,IAAC,CAAA,GAAG,CAAC,OALd;;IAFM;;IASR,KAAO,CAAA,CAAA;AACL,UAAA,CAAA,EAAA,CAAA,EAAA,GAAA,EAAA,EAAA,EAAA;MAAA,GAAA,GAAM,GAAG,CAAC,MAAJ,CAAW,KAAX,EAAiB;QAAC,OAAA,EAAQ,KAAT;QAAe,QAAA,EAAS,OAAxB;QAAgC,UAAA,EAAW;MAA3C,CAAjB;MACN,GAAG,CAAC,GAAJ,CAAQ,OAAR,EAAgB,2DAAhB;MACA,GAAG,CAAC,GAAJ,CAAQ,OAAR,EAAgB,EAAA,GAAG,IAAC,CAAA,GAAG,CAAC,MAAxB;MACA,GAAG,CAAC,GAAJ,CAAQ,aAAR,EAAsB,EAAA,GAAG,IAAC,CAAA,GAAG,CAAC,MAA9B;MACA,KAAS,wFAAT;QACE,EAAA,GAAK,GAAG,CAAC,GAAJ,CAAQ,IAAR;QACL,EAAE,CAAC,GAAH,CAAO,GAAP,EAAW,IAAC,CAAA,GAAI,CAAA,CAAA,CAAhB;QACA,EAAE,CAAC,GAAH,CAAO,YAAP,EAAoB;UAAC,MAAA,EAAO,CAAR;UAAU,IAAA,EAAK;QAAf,CAApB;MAHF;AAIA,aAAO,GAAG,CAAC,GAAJ,CAAA;IATF;;EAdT;;EAyBM,QAAN,MAAA,MAAA;IACE,WAAa,KAAA,OAAA,OAAA,OAAA,CAAA;AACX,UAAA,CAAA,EAAA,CAAA,EAAA,CAAA,EAAA,CAAA,EAAA,GAAA,EAAA;MADY,IAAC,CAAA;MAAM,IAAC,CAAA;MAAM,IAAC,CAAA;MAAM,IAAC,CAAA;MAClC,IAAC,CAAA,IAAD,GAAQ,IAAC,CAAA,IAAI,CAAC,OAAN,CAAc,cAAd,EAA4B,GAA5B;MAGR,IAAC,CAAA,IAAD,GAAQ,CAAA;MACR,KAAS,oFAAT;QACE,IAAC,CAAA,IAAK,CAAA,CAAA,CAAN,GAAW,CAAA;QACX,KAAS,yFAAT;UACE,IAAC,CAAA,IAAK,CAAA,CAAA,CAAG,CAAA,CAAA,CAAT,GAAc;YAAC,CAAA,EAAE;UAAH;QADhB;MAFF;MAIA,IAAC,CAAA,MAAD,GAAU;MACV,IAAC,CAAA,MAAD,GAAU;MACV,IAAC,CAAA,MAAD,GAAU,CAAA;MACV,IAAC,CAAA,MAAD,GAAU,CAAA;IAZC;;IAeb,GAAK,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CAAA;AACH,UAAA;MAAA,IAAG,GAAA,YAAe,IAAlB;QACE,IAAC,CAAA,GAAD,CAAK,GAAL,EAAU,GAAV,EAAe,aAAA,CAAc,GAAd,CAAf,EAAA;;QAEA,IAAC,CAAA,IAAD,CAAM,GAAN,EAAW,GAAX,EACE;UAAA,IAAA,EAAM,OAAN;UACA,OAAA,EAAS;QADT,CADF;QAGA,IAAC,CAAA,YAAD,CAAc,GAAd,EAAmB,GAAnB,EAAwB,OAAxB,EANF;OAAA,MAOK,IAAG,OAAO,GAAP,KAAc,QAAjB;QACH,KAAA,UAAA;UACE,IAAE,CAAA,GAAA,CAAF,CAAO,GAAP,EAAY,GAAZ,EAAiB,GAAI,CAAA,GAAA,CAArB;QADF,CADG;OAAA,MAGA,IAAI,OAAO,GAAP,KAAc,QAAlB;QACH,IAAG,GAAA,KAAO,IAAP,IAAgB,GAAA,KAAO,EAA1B;UACE,IAAC,CAAA,IAAK,CAAA,GAAA,CAAK,CAAA,GAAA,CAAI,CAAC,CAAhB,GAAoB,IAAC,CAAA,IAAI,CAAC,EAAE,CAAC,MAAT,CAAgB,EAAA,GAAK,GAArB,EADtB;;AAEA,eAAO,IAAC,CAAA,IAAK,CAAA,GAAA,CAAK,CAAA,GAAA,CAAI,CAAC,QAAhB,GAA2B,SAH/B;OAAA,MAIA,IAAG,OAAO,GAAP,KAAc,QAAjB;QACH,IAAC,CAAA,IAAK,CAAA,GAAA,CAAK,CAAA,GAAA,CAAI,CAAC,CAAhB,GAAoB;AACpB,eAAO,IAAC,CAAA,IAAK,CAAA,GAAA,CAAK,CAAA,GAAA,CAAI,CAAC,QAAhB,GAA2B,SAF/B;OAAA,MAAA;QAIH,IAAC,CAAA,IAAK,CAAA,GAAA,CAAK,CAAA,GAAA,CAAI,CAAC,CAAhB,GAAoB,IAJjB;;IAfF;;IAsBL,KAAO,CAAC,SAAD,EAAY,OAAZ,CAAA;aACL,IAAC,CAAA,MAAM,CAAC,IAAR,CAAa;QAAC,IAAA,EAAK,SAAN;QAAiB,EAAA,EAAG;MAApB,CAAb;IADK;;IAGP,KAAO,CAAC,GAAD,EAAM,EAAN,CAAA;aACL,IAAC,CAAA,MAAM,CAAC,IAAR,CAAa;QAAC,CAAA,EAAE,GAAH;QAAO,EAAA,EAAG;MAAV,CAAb;IADK;;IAGP,MAAQ,CAAC,GAAD,EAAM,EAAN,CAAA;aACN,IAAC,CAAA,MAAO,CAAA,GAAA,CAAR,GAAe;IADT;;IAGR,IAAM,CAAC,GAAD,EAAM,GAAN,EAAW,MAAX,CAAA;aACJ,IAAC,CAAA,MAAO,CAAA,OAAA,GAAQ,GAAR,GAAY,GAAZ,GAAgB,GAAhB,CAAR,GAA+B,IAAC,CAAA,IAAI,CAAC,EAAE,CAAC,OAAT,CAAiB,MAAjB;IAD3B;;IAGN,IAAM,CAAC,GAAD,EAAM,GAAN,EAAW,MAAX,CAAA;aACJ,IAAC,CAAA,MAAO,CAAA,OAAA,GAAQ,GAAR,GAAY,GAAZ,GAAgB,GAAhB,CAAR,GAA+B,IAAC,CAAA,IAAI,CAAC,EAAE,CAAC,OAAT,CAAiB,MAAjB;IAD3B;;IAGN,MAAQ,CAAC,GAAD,EAAM,GAAN,EAAW,MAAX,CAAA;aACN,IAAC,CAAA,MAAO,CAAA,OAAA,GAAQ,GAAR,GAAY,GAAZ,GAAgB,GAAhB,CAAR,GAA+B,IAAC,CAAA,IAAI,CAAC,EAAE,CAAC,OAAT,CAAiB,MAAjB;IADzB;;IAGR,YAAc,CAAC,GAAD,EAAM,GAAN,EAAW,QAAX,CAAA;aACZ,IAAC,CAAA,MAAO,CAAA,SAAA,GAAU,GAAV,GAAc,GAAd,GAAkB,GAAlB,CAAR,GAAiC,IAAC,CAAA,IAAI,CAAC,EAAE,CAAC,SAAT,CAAmB,QAAnB;IADrB;;IAGd,KAAO,CAAC,GAAD,EAAM,GAAN,EAAW,OAAX,CAAA;aACL,IAAC,CAAA,MAAO,CAAA,OAAA,GAAQ,GAAR,GAAY,GAAZ,GAAgB,GAAhB,CAAR,GAA+B;IAD1B;;IAGP,MAAQ,CAAC,GAAD,EAAM,GAAN,EAAW,QAAX,CAAA;aACN,IAAC,CAAA,MAAO,CAAA,QAAA,GAAS,GAAT,GAAa,GAAb,GAAiB,GAAjB,CAAR,GAAgC;IAD1B;;IAGR,MAAQ,CAAC,GAAD,EAAM,GAAN,EAAW,YAAX,CAAA;aACN,IAAC,CAAA,MAAO,CAAA,SAAA,GAAU,GAAV,GAAc,GAAd,GAAkB,GAAlB,CAAR,GAAiC;IAD3B;;IAGR,IAAM,CAAC,GAAD,EAAM,GAAN,EAAW,MAAX,CAAA;aACJ,IAAC,CAAA,MAAO,CAAA,OAAA,GAAQ,GAAR,GAAY,GAAZ,GAAgB,GAAhB,CAAR,GAA+B;IAD3B;;IAGN,UAAY,CAAE,QAAF,CAAA;aACV,IAAC,CAAA,UAAD,GAAiB,OAAO,QAAP,KAAmB,QAAtB,GAAoC,QAApC,GAAkD,IAAC,CAAA,QAAD,CAAA;IADtD;;IAGZ,QAAU,CAAC,GAAD,EAAM,GAAN,CAAA;AACR,UAAA,EAAA,EAAA,GAAA,EAAA;MAAA,GAAA,GAAM,GAAA,GAAI,GAAJ,GAAQ,GAAR,GAAY;MAClB,KAAA,GAAQ;QAAC,SAAA,EAAW,IAAC,CAAA,MAAO,CAAA,QAAA,GAAS,GAAT,CAApB;QAAkC,OAAA,EAAQ,IAAC,CAAA,MAAO,CAAA,MAAA,GAAO,GAAP,CAAlD;QAA8D,OAAA,EAAQ,IAAC,CAAA,MAAO,CAAA,MAAA,GAAO,GAAP,CAA9E;QAA0F,OAAA,EAAQ,IAAC,CAAA,MAAO,CAAA,MAAA,GAAO,GAAP,CAA1G;QAAsH,KAAA,EAAM,IAAC,CAAA,MAAO,CAAA,MAAA,GAAO,GAAP,CAApI;QAAgJ,MAAA,EAAO,IAAC,CAAA,MAAO,CAAA,OAAA,GAAQ,GAAR,CAA/J;QAA4K,MAAA,EAAO,IAAC,CAAA,MAAO,CAAA,QAAA,GAAS,GAAT,CAA3L;QAAyM,IAAA,EAAK,IAAC,CAAA,MAAO,CAAA,MAAA,GAAO,GAAP;MAAtN;MACR,EAAA,GAAK,IAAC,CAAA,IAAI,CAAC,EAAE,CAAC,QAAT,CAAkB,KAAlB;AACL,aAAQ;IAJA;;IAMV,QAAU,CAAA,CAAA;AACR,aAAO,QAAA,GAAU,IAAI,CAAC,GAAL,CAAS,IAAC,CAAA,IAAV,CAAV,GAA0B,GAA1B,GAA8B,IAAC,CAAA;IAD9B;;IAGV,KAAO,CAAA,CAAA;AACL,UAAA,CAAA,EAAA,IAAA,EAAA,EAAA,EAAA,EAAA,EAAA,CAAA,EAAA,EAAA,EAAA,CAAA,EAAA,CAAA,EAAA,GAAA,EAAA,IAAA,EAAA,CAAA,EAAA,EAAA,EAAA,CAAA,EAAA,CAAA,EAAA,CAAA,EAAA,CAAA,EAAA,GAAA,EAAA,IAAA,EAAA,IAAA,EAAA,IAAA,EAAA,EAAA,EAAA,GAAA,EAAA;MAAA,EAAA,GAAK,GAAG,CAAC,MAAJ,CAAW,WAAX,EAAuB;QAAC,OAAA,EAAQ,KAAT;QAAe,QAAA,EAAS,OAAxB;QAAgC,UAAA,EAAW;MAA3C,CAAvB;MACL,EAAE,CAAC,GAAH,CAAO,OAAP,EAAe,2DAAf;MACA,EAAE,CAAC,GAAH,CAAO,SAAP,EAAiB,qEAAjB;MACA,EAAE,CAAC,GAAH,CAAO,WAAP,EAAmB;QAAC,GAAA,EAAI;MAAL,CAAnB;MACA,EAAE,CAAC,GAAH,CAAO,YAAP,CAAoB,CAAC,GAArB,CAAyB,WAAzB,EAAqC;QAAC,cAAA,EAAe;MAAhB,CAArC;MACA,EAAE,CAAC,GAAH,CAAO,eAAP,EAAuB;QAAC,gBAAA,EAAiB;MAAlB,CAAvB;MACA,IAAG,IAAC,CAAA,MAAM,CAAC,MAAR,GAAiB,CAApB;QACE,IAAA,GAAO,EAAE,CAAC,GAAH,CAAO,MAAP;AACP;QAAA,KAAA,qCAAA;;UACE,IAAI,CAAC,GAAL,CAAS,KAAT,EAAe;YAAC,GAAA,EAAI,EAAA,GAAG,EAAE,CAAC,CAAX;YAAa,GAAA,EAAI,EAAA,GAAG,EAAE,CAAC,CAAvB;YAAyB,KAAA,EAAM,EAAE,CAAC,EAAlC;YAAqC,WAAA,EAAY;UAAjD,CAAf;QADF,CAFF;;MAIA,EAAA,GAAK,EAAE,CAAC,GAAH,CAAO,WAAP;MACL,KAAS,yFAAT;QACE,CAAA,GAAI,EAAE,CAAC,GAAH,CAAO,KAAP,EAAa;UAAC,CAAA,EAAE,EAAA,GAAG,CAAN;UAAQ,KAAA,EAAM,IAAA,GAAK,IAAC,CAAA;QAApB,CAAb;QACJ,EAAA,GAAK,IAAC,CAAA,MAAO,CAAA,CAAA;QACb,IAAG,EAAH;UACE,CAAC,CAAC,GAAF,CAAM,IAAN,EAAW,EAAX;UACA,CAAC,CAAC,GAAF,CAAM,cAAN,EAAqB,GAArB,EAFF;;QAGA,KAAS,yFAAT;UACE,EAAA,GAAK,IAAC,CAAA,IAAK,CAAA,CAAA,CAAG,CAAA,CAAA;UACd,GAAA,GAAM,IAAC,CAAA,QAAD,CAAU,CAAV,EAAa,CAAb;UACN,IAAG,CAAC,EAAE,CAAC,CAAH,KAAU,IAAV,IAAmB,EAAE,CAAC,CAAH,KAAU,MAA9B,CAAA,IAA4C,CAAC,GAAA,KAAS,CAAV,CAA/C;YACE,CAAA,GAAI,CAAC,CAAC,GAAF,CAAM,GAAN,EAAU;cAAC,CAAA,EAAE,EAAA,GAAG,IAAI,CAAC,GAAL,CAAS,CAAT,CAAH,GAAe;YAAlB,CAAV;YACJ,IAAyB,GAAA,KAAS,CAAlC;cAAA,CAAC,CAAC,GAAF,CAAM,GAAN,EAAU,EAAA,GAAG,CAAC,GAAA,GAAI,CAAL,CAAb,EAAA;;YACA,IAAG,EAAE,CAAC,QAAH,KAAe,QAAlB;cACE,CAAC,CAAC,GAAF,CAAM,GAAN,EAAU,GAAV;cACA,CAAC,CAAC,GAAF,CAAM,GAAN,EAAU,EAAA,GAAG,CAAC,EAAE,CAAC,CAAH,GAAK,CAAN,CAAb,EAFF;aAAA,MAGK,IAAG,EAAE,CAAC,QAAH,KAAe,QAAlB;cACH,CAAC,CAAC,GAAF,CAAM,GAAN,EAAW,EAAA,GAAG,EAAE,CAAC,CAAjB,EADG;aANP;;QAHF;MANF;MAkBA,IAAG,IAAC,CAAA,MAAM,CAAC,MAAR,GAAiB,CAApB;QACE,EAAA,GAAK,EAAE,CAAC,GAAH,CAAO,YAAP,EAAoB;UAAC,KAAA,EAAM,IAAC,CAAA,MAAM,CAAC;QAAf,CAApB;AACL;QAAA,KAAA,wCAAA;;UACE,EAAE,CAAC,GAAH,CAAO,WAAP,EAAmB;YAAC,GAAA,EAAK,EAAA,GAAG,IAAI,CAAC,GAAL,CAAS,CAAC,CAAC,IAAI,CAAC,GAAhB,CAAH,GAAwB,CAAC,CAAC,IAAI,CAAC,GAA/B,GAAmC,GAAnC,GAAuC,IAAI,CAAC,GAAL,CAAS,CAAC,CAAC,EAAE,CAAC,GAAd,CAAvC,GAA0D,CAAC,CAAC,EAAE,CAAC;UAArE,CAAnB;QADF,CAFF;;MAIA,IAAG,OAAO,IAAC,CAAA,UAAR,KAAsB,QAAzB;QACE,EAAE,CAAC,GAAH,CAAO,YAAP,EAAqB;UAAC,GAAA,EAAK,IAAC,CAAA;QAAP,CAArB,EADF;;MAEA,EAAE,CAAC,GAAH,CAAO,YAAP,EAAoB;QAAC,MAAA,EAAO,GAAR;QAAY,IAAA,EAAK;MAAjB,CAApB;MACA,EAAE,CAAC,GAAH,CAAO,aAAP,EAAqB;QAAC,IAAA,EAAK,KAAN;QAAY,KAAA,EAAM,KAAlB;QAAwB,GAAA,EAAI,MAA5B;QAAmC,MAAA,EAAO,MAA1C;QAAiD,MAAA,EAAO,KAAxD;QAA8D,MAAA,EAAO;MAArE,CAArB;MACA,EAAE,CAAC,GAAH,CAAO,WAAP,EAAmB;QAAC,SAAA,EAAU,GAAX;QAAe,WAAA,EAAY,UAA3B;QAAsC,aAAA,EAAc,KAApD;QAA0D,WAAA,EAAY;MAAtE,CAAnB;AACA,aAAO,EAAE,CAAC,GAAH,CAAA;IAvCF;;EAnFT;;EA4HM;IAAN,MAAA,MAAA;MAmCE,WAAa,KAAA,CAAA;QAAC,IAAC,CAAA;QACb,IAAC,CAAA,KAAD,GAAS,CAAA;QACT,IAAC,CAAA,MAAD,GAAU,GADV;QAEA,IAAC,CAAA,MAAD,GAAU,GAFV;QAGA,IAAC,CAAA,MAAD,GAAU,GAHV;QAIA,IAAC,CAAA,MAAD,GAAU,GAJV;QAKA,IAAC,CAAA,YAAD,CAAA;MANW;;MAQb,YAAa,CAAA,CAAA;QACX,IAAC,CAAA,WAAD,GAAe,IAAC,CAAA,OAAD,CAAS,IAAT;QACf,IAAC,CAAA,WAAD,GAAe,IAAC,CAAA,OAAD,CAAS,IAAT;QACf,IAAC,CAAA,WAAD,GAAe,IAAC,CAAA,OAAD,CAAS,IAAT;QACf,IAAC,CAAA,SAAD,GAAa;QACb,IAAC,CAAA,UAAD,GAAc;QACd,IAAC,CAAA,UAAD,GAAc;QACd,IAAC,CAAA,QAAD,GAAY;eACZ,IAAC,CAAA,YAAD,GAAgB,IAAC,CAAA,QAAD,CAAU;UAAC,OAAA,EAAQ,IAAC,CAAA,WAAV;UAAsB,OAAA,EAAQ,IAAC,CAAA,WAA/B;UAA2C,OAAA,EAAQ,IAAC,CAAA,WAApD;UAAgE,KAAA,EAAM,IAAC,CAAA,SAAvE;UAAiF,MAAA,EAAO,IAAC,CAAA,UAAzF;UAAoG,MAAA,EAAO,IAAC,CAAA;QAA5G,CAAV;MARL;;MAUb,OAAS,CAAC,IAAD,CAAA;AACP,YAAA,EAAA,EAAA;QAAA,SAAA,OAAS,CAAA;QACT,IAAI,CAAC,SAAL,IAAI,CAAC,OAAS;QACd,IAAI,CAAC,SAAL,IAAI,CAAC,OAAS;QACd,IAAI,CAAC,OAAL,IAAI,CAAC,KAAO;QACZ,IAAI,CAAC,UAAL,IAAI,CAAC,QAAU;QACf,IAAI,CAAC,SAAL,IAAI,CAAC,OAAS;QACd,IAAI,CAAC,WAAL,IAAI,CAAC,SAAU;QACf,IAAI,CAAC,WAAL,IAAI,CAAC,SAAW;QAChB,CAAA,GAAI,OAAA,GAAQ,IAAI,CAAC,IAAb,GAAkB,IAAI,CAAC,IAAvB,GAA4B,IAAI,CAAC,EAAjC,GAAoC,IAAI,CAAC,KAAzC,GAA+C,IAAI,CAAC,IAApD,GAAyD,IAAI,CAAC,MAA9D,GAAqE,IAAI,CAAC;QAC9E,EAAA,GAAK,IAAC,CAAA,KAAM,CAAA,CAAA;QACZ,IAAG,EAAH;AACE,iBAAO,GADT;SAAA,MAAA;UAGE,IAAC,CAAA,MAAM,CAAC,IAAR,CAAa,IAAb;UACA,IAAC,CAAA,KAAM,CAAA,CAAA,CAAP,GAAY,IAAC,CAAA,MAAM,CAAC;AACpB,iBAAO,IAAC,CAAA,MAAM,CAAC,OALjB;;MAXO;;MAkBT,OAAS,CAAC,IAAD,CAAA;AACP,YAAA,EAAA,EAAA;QAAA,SAAA,OAAS,CAAA;QACT,IAAI,CAAC,SAAL,IAAI,CAAC,OAAS;QACd,IAAI,CAAC,YAAL,IAAI,CAAC,UAAY;QACjB,IAAI,CAAC,YAAL,IAAI,CAAC,UAAY;QACjB,CAAA,GAAI,OAAA,GAAU,IAAI,CAAC,IAAf,GAAsB,IAAI,CAAC,OAA3B,GAAqC,IAAI,CAAC;QAC9C,EAAA,GAAK,IAAC,CAAA,KAAM,CAAA,CAAA;QACZ,IAAG,EAAH;AACE,iBAAO,GADT;SAAA,MAAA;UAGE,IAAC,CAAA,MAAM,CAAC,IAAR,CAAa,IAAb;UACA,IAAC,CAAA,KAAM,CAAA,CAAA,CAAP,GAAY,IAAC,CAAA,MAAM,CAAC;AACpB,iBAAO,IAAC,CAAA,MAAM,CAAC,OALjB;;MAPO;;MAcT,OAAS,CAAC,IAAD,CAAA;AACP,YAAA,EAAA,EAAA;QAAA,SAAA,OAAS,CAAA;QACT,IAAI,CAAC,SAAL,IAAI,CAAC,OAAS;QACd,IAAI,CAAC,UAAL,IAAI,CAAC,QAAU;QACf,IAAI,CAAC,QAAL,IAAI,CAAC,MAAQ;QACb,IAAI,CAAC,WAAL,IAAI,CAAC,SAAW;QAChB,CAAA,GAAI,OAAA,GAAQ,IAAI,CAAC,IAAb,GAAkB,GAAlB,GAAsB,IAAI,CAAC,KAA3B,GAAiC,GAAjC,GAAqC,IAAI,CAAC,GAA1C,GAA8C,GAA9C,GAAkD,IAAI,CAAC;QAC3D,EAAA,GAAK,IAAC,CAAA,KAAM,CAAA,CAAA;QACZ,IAAG,EAAH;AACE,iBAAO,GADT;SAAA,MAAA;UAGE,IAAC,CAAA,MAAM,CAAC,IAAR,CAAa,IAAb;UACA,IAAC,CAAA,KAAM,CAAA,CAAA,CAAP,GAAY,IAAC,CAAA,MAAM,CAAC;AACpB,iBAAO,IAAC,CAAA,MAAM,CAAC,OALjB;;MARO;;MAeT,SAAW,CAAC,MAAD,CAAA;AACT,YAAA;QAAA,IAAG,OAAO,MAAP,KAAiB,QAApB;AACE,iBAAO,OADT;SAAA,MAEK,IAAG,OAAO,MAAP,KAAiB,QAApB;UACH,KAAA,yBAAA;YACE,IAAG,IAAC,CAAA,aAAc,CAAA,GAAA,CAAf,KAAuB,MAA1B;AACE,qBAAO,IADT;;UADF;UAIA,MAAM,gBAAA,GAAiB,MAAjB,GAA0B,yDAL7B;;MAHI;;MAUX,QAAS,CAAC,KAAD,CAAA;AACP,YAAA,EAAA,EAAA;QAAA,KAAK,CAAC,UAAN,KAAK,CAAC,QAAU,IAAC,CAAA;QACjB,KAAK,CAAC,WAAN,KAAK,CAAC,SAAW,IAAC,CAAA;QAClB,KAAK,CAAC,WAAN,KAAK,CAAC,SAAW,IAAC,CAAA;QAClB,KAAK,CAAC,SAAN,KAAK,CAAC,OAAS,IAAC,CAAA;QAChB,KAAK,CAAC,YAAN,KAAK,CAAC,UAAY,IAAC,CAAA;QACnB,KAAK,CAAC,YAAN,KAAK,CAAC,UAAY,IAAC,CAAA;QACnB,KAAK,CAAC,YAAN,KAAK,CAAC,UAAY,IAAC,CAAA;QACnB,CAAA,GAAI,IAAA,GAAO,KAAK,CAAC,OAAb,GAAuB,GAAvB,GAA6B,KAAK,CAAC,OAAnC,GAA6C,GAA7C,GAAmD,KAAK,CAAC,OAAzD,GAAmE,GAAnE,GAAyE,KAAK,CAAC,KAA/E,GAAuF,GAAvF,GAA6F,KAAK,CAAC,MAAnG,GAA4G,GAA5G,GAAkH,KAAK,CAAC,IAAxH,GAA+H,GAA/H,GAAqI,KAAK,CAAC;QAC/I,EAAA,GAAK,IAAC,CAAA,KAAM,CAAA,CAAA;QACZ,IAAG,EAAH;AACE,iBAAO,GADT;SAAA,MAAA;UAGE,IAAC,CAAA,MAAM,CAAC,IAAR,CAAa,KAAb;UACA,IAAC,CAAA,KAAM,CAAA,CAAA,CAAP,GAAY,IAAC,CAAA,MAAM,CAAC;AACpB,iBAAO,IAAC,CAAA,MAAM,CAAC,OALjB;;MAVO;;MAiBT,KAAO,CAAA,CAAA;AACL,YAAA,KAAA,EAAA,EAAA,EAAA,CAAA,EAAA,EAAA,EAAA,EAAA,EAAA,KAAA,EAAA,KAAA,EAAA,CAAA,EAAA,GAAA,EAAA,IAAA,EAAA,IAAA,EAAA,IAAA,EAAA,CAAA,EAAA,CAAA,EAAA,CAAA,EAAA,CAAA,EAAA,GAAA,EAAA,IAAA,EAAA,IAAA,EAAA,IAAA,EAAA;QAAA,EAAA,GAAK,GAAG,CAAC,MAAJ,CAAW,YAAX,EAAwB;UAAC,OAAA,EAAQ,KAAT;UAAe,QAAA,EAAS,OAAxB;UAAgC,UAAA,EAAW;QAA3C,CAAxB;QACL,EAAE,CAAC,GAAH,CAAO,OAAP,EAAe,2DAAf;QACA,KAAA,GAAQ,EAAE,CAAC,GAAH,CAAO,OAAP,EAAe;UAAC,KAAA,EAAM,IAAC,CAAA,MAAM,CAAC;QAAf,CAAf;AACR;QAAA,KAAA,qCAAA;;UACE,CAAA,GAAI,KAAK,CAAC,GAAN,CAAU,MAAV;UACJ,IAAc,CAAC,CAAC,IAAF,KAAY,GAA1B;YAAA,CAAC,CAAC,GAAF,CAAM,GAAN,EAAA;;UACA,IAAc,CAAC,CAAC,IAAF,KAAY,GAA1B;YAAA,CAAC,CAAC,GAAF,CAAM,GAAN,EAAA;;UACA,CAAC,CAAC,GAAF,CAAM,IAAN,EAAW;YAAC,GAAA,EAAI,CAAC,CAAC;UAAP,CAAX;UACA,IAAgC,CAAC,CAAC,KAAF,KAAa,GAA7C;YAAA,CAAC,CAAC,GAAF,CAAM,OAAN,EAAc;cAAC,GAAA,EAAI,CAAC,CAAC;YAAP,CAAd,EAAA;;UACA,CAAC,CAAC,GAAF,CAAM,MAAN,EAAa;YAAC,GAAA,EAAI,CAAC,CAAC;UAAP,CAAb;UACA,CAAC,CAAC,GAAF,CAAM,QAAN,EAAe;YAAC,GAAA,EAAI,CAAC,CAAC;UAAP,CAAf;UACA,CAAC,CAAC,GAAF,CAAM,SAAN,EAAgB;YAAC,GAAA,EAAI;UAAL,CAAhB;UACA,IAAiC,CAAC,CAAC,MAAF,KAAc,GAA/C;YAAA,CAAC,CAAC,GAAF,CAAM,QAAN,EAAe;cAAC,GAAA,EAAI;YAAL,CAAf,EAAA;;QATF;QAUA,KAAA,GAAQ,EAAE,CAAC,GAAH,CAAO,OAAP,EAAe;UAAC,KAAA,EAAM,IAAC,CAAA,MAAM,CAAC,MAAR,GAAe;QAAtB,CAAf;QACR,KAAK,CAAC,GAAN,CAAU,MAAV,CAAiB,CAAC,GAAlB,CAAsB,aAAtB,EAAqC;UAAC,WAAA,EAAa;QAAd,CAArC;QACA,KAAK,CAAC,GAAN,CAAU,MAAV,CAAiB,CAAC,GAAlB,CAAsB,aAAtB,EAAqC;UAAC,WAAA,EAAa;QAAd,CAArC;AAGA;;QAAA,KAAA,wCAAA;;UACE,CAAA,GAAI,KAAK,CAAC,GAAN,CAAU,MAAV;UACJ,EAAA,GAAK,CAAC,CAAC,GAAF,CAAM,aAAN,EAAoB;YAAC,WAAA,EAAY,CAAC,CAAC;UAAf,CAApB;UACL,IAAuC,CAAC,CAAC,OAAF,KAAe,GAAtD;YAAA,EAAE,CAAC,GAAH,CAAO,SAAP,EAAiB;cAAC,GAAA,EAAM,CAAC,CAAC;YAAT,CAAjB,EAAA;;UACA,IAAyC,CAAC,CAAC,OAAF,KAAe,GAAxD;YAAA,EAAE,CAAC,GAAH,CAAO,SAAP,EAAiB;cAAC,OAAA,EAAQ,CAAC,CAAC;YAAX,CAAjB,EAAA;;QAJF;QAKA,KAAA,GAAQ,EAAE,CAAC,GAAH,CAAO,SAAP,EAAiB;UAAC,KAAA,EAAM,IAAC,CAAA,MAAM,CAAC;QAAf,CAAjB;AACR;QAAA,KAAA,wCAAA;;UAEE,CAAA,GAAI,KAAK,CAAC,GAAN,CAAU,QAAV;UACJ,IAAG,CAAC,CAAC,IAAF,KAAY,GAAf;YAAwB,CAAC,CAAC,GAAF,CAAM,MAAN,EAAa;cAAC,KAAA,EAAM,CAAC,CAAC;YAAT,CAAb,CAA4B,CAAC,GAA7B,CAAiC,OAAjC,EAAyC;cAAC,IAAA,EAAK;YAAN,CAAzC,EAAxB;WAAA,MAAA;YAAkF,CAAC,CAAC,GAAF,CAAM,MAAN,EAAlF;;UACA,IAAG,CAAC,CAAC,KAAF,KAAa,GAAhB;YAAyB,CAAC,CAAC,GAAF,CAAM,OAAN,EAAc;cAAC,KAAA,EAAM,CAAC,CAAC;YAAT,CAAd,CAA8B,CAAC,GAA/B,CAAmC,OAAnC,EAA2C;cAAC,IAAA,EAAK;YAAN,CAA3C,EAAzB;WAAA,MAAA;YAAqF,CAAC,CAAC,GAAF,CAAM,OAAN,EAArF;;UACA,IAAG,CAAC,CAAC,GAAF,KAAW,GAAd;YAAuB,CAAC,CAAC,GAAF,CAAM,KAAN,EAAY;cAAC,KAAA,EAAM,CAAC,CAAC;YAAT,CAAZ,CAA0B,CAAC,GAA3B,CAA+B,OAA/B,EAAuC;cAAC,IAAA,EAAK;YAAN,CAAvC,EAAvB;WAAA,MAAA;YAA+E,CAAC,CAAC,GAAF,CAAM,KAAN,EAA/E;;UACA,IAAG,CAAC,CAAC,MAAF,KAAc,GAAjB;YAA0B,CAAC,CAAC,GAAF,CAAM,QAAN,EAAe;cAAC,KAAA,EAAM,CAAC,CAAC;YAAT,CAAf,CAAgC,CAAC,GAAjC,CAAqC,OAArC,EAA6C;cAAC,IAAA,EAAK;YAAN,CAA7C,EAA1B;WAAA,MAAA;YAAwF,CAAC,CAAC,GAAF,CAAM,QAAN,EAAxF;;UACA,CAAC,CAAC,GAAF,CAAM,UAAN;QAPF;QAQA,EAAE,CAAC,GAAH,CAAO,cAAP,EAAsB;UAAC,KAAA,EAAM;QAAP,CAAtB,CAAkC,CAAC,GAAnC,CAAuC,IAAvC,EAA4C;UAAC,QAAA,EAAS,GAAV;UAAc,MAAA,EAAO,GAArB;UAAyB,MAAA,EAAO,GAAhC;UAAoC,QAAA,EAAS;QAA7C,CAA5C,CAA8F,CAAC,GAA/F,CAAmG,WAAnG,EAA+G;UAAC,QAAA,EAAS;QAAV,CAA/G;QACA,EAAA,GAAK,EAAE,CAAC,GAAH,CAAO,SAAP,EAAiB;UAAC,KAAA,EAAM,IAAC,CAAA,MAAM,CAAC;QAAf,CAAjB;AACL;QAAA,KAAA,wCAAA;;UACE,CAAA,GAAI,EAAE,CAAC,GAAH,CAAO,IAAP,EAAY;YAAC,QAAA,EAAU,CAAC,CAAC,SAAF,IAAa,GAAxB;YAA4B,MAAA,EAAQ,CAAC,CAAC,OAAF,GAAU,CAA9C;YAAiD,MAAA,EAAO,CAAC,CAAC,OAAF,GAAU,CAAlE;YAAoE,QAAA,EAAU,CAAC,CAAC,OAAF,GAAU,CAAxF;YAA2F,IAAA,EAAK;UAAhG,CAAZ;UACJ,IAA0B,CAAC,CAAC,OAAF,KAAe,CAAzC;YAAA,CAAC,CAAC,GAAF,CAAM,WAAN,EAAkB,GAAlB,EAAA;;UACA,IAA0B,CAAC,CAAC,OAAF,KAAe,CAAzC;YAAA,CAAC,CAAC,GAAF,CAAM,WAAN,EAAkB,GAAlB,EAAA;;UACA,IAAkC,CAAC,CAAC,SAAF,KAAiB,MAAnD;YAAA,CAAC,CAAC,GAAF,CAAM,mBAAN,EAA0B,GAA1B,EAAA;;UACA,IAA4B,CAAC,CAAC,OAAF,KAAe,CAA3C;YAAA,CAAC,CAAC,GAAF,CAAM,aAAN,EAAoB,GAApB,EAAA;;UACA,IAAG,CAAC,CAAC,KAAF,KAAa,GAAb,IAAoB,CAAC,CAAC,MAAF,KAAc,GAAlC,IAAyC,CAAC,CAAC,IAAF,KAAY,GAAxD;YACE,CAAC,CAAC,GAAF,CAAM,gBAAN,EAAuB,GAAvB;YACA,EAAA,GAAK,CAAC,CAAC,GAAF,CAAM,WAAN,EAAkB;cAAC,YAAA,EAAa,CAAI,CAAC,CAAC,MAAF,KAAY,GAAf,GAAwB,GAAxB,GAAiC,CAAC,CAAC,MAApC,CAAd;cAA0D,UAAA,EAAW,CAAI,CAAC,CAAC,KAAF,KAAW,GAAd,GAAuB,MAAvB,GAAmC,CAAC,CAAC,KAAtC,CAArE;cAAmH,QAAA,EAAS,CAAI,CAAC,CAAC,MAAF,KAAY,GAAf,GAAwB,KAAxB,GAAmC,CAAC,CAAC,MAAtC;YAA5H,CAAlB;YACL,IAA0B,CAAC,CAAC,IAAF,KAAY,GAAtC;cAAA,EAAE,CAAC,GAAH,CAAO,UAAP,EAAkB,GAAlB,EAAA;aAHF;;QANF;QAUA,EAAE,CAAC,GAAH,CAAO,YAAP,EAAoB;UAAC,KAAA,EAAM;QAAP,CAApB,CAAgC,CAAC,GAAjC,CAAqC,WAArC,EAAiD;UAAC,IAAA,EAAK,IAAN;UAAW,IAAA,EAAK,GAAhB;UAAoB,SAAA,EAAU;QAA9B,CAAjD;QACA,EAAE,CAAC,GAAH,CAAO,MAAP,EAAc;UAAC,KAAA,EAAM;QAAP,CAAd;QACA,EAAE,CAAC,GAAH,CAAO,aAAP,EAAqB;UAAC,KAAA,EAAM,GAAP;UAAW,iBAAA,EAAkB,mBAA7B;UAAiD,iBAAA,EAAkB;QAAnE,CAArB;AACA,eAAO,EAAE,CAAC,GAAH,CAAA;MAhDF;;IA/HT;;oBAEE,aAAA,GAAe;MACb,CAAA,EAAG,SADU;MAEb,CAAA,EAAG,GAFU;MAGb,CAAA,EAAG,MAHU;MAIb,CAAA,EAAG,OAJU;MAKb,CAAA,EAAG,UALU;MAMb,CAAA,EAAG,IANU;MAOb,EAAA,EAAI,OAPS;MAQb,EAAA,EAAI,UARS;MASb,EAAA,EAAI,OATS;MAUb,EAAA,EAAI,SAVS;MAWb,EAAA,EAAI,QAXS;MAYb,EAAA,EAAI,UAZS;MAab,EAAA,EAAI,OAbS;MAcb,EAAA,EAAI,QAdS;MAeb,EAAA,EAAI,YAfS;MAgBb,EAAA,EAAI,eAhBS;MAiBb,EAAA,EAAI,MAjBS;MAkBb,EAAA,EAAI,SAlBS;MAmBb,EAAA,EAAI,aAnBS;MAoBb,EAAA,EAAI,gBApBS;MAqBb,EAAA,EAAI,qBArBS;MAsBb,EAAA,EAAI,qBAtBS;MAuBb,EAAA,EAAI,0BAvBS;MAwBb,EAAA,EAAI,OAxBS;MAyBb,EAAA,EAAI,WAzBS;MA0Bb,EAAA,EAAI,QA1BS;MA2Bb,EAAA,EAAI,UA3BS;MA4Bb,EAAA,EAAI,GA5BS;MA6Bb,EAAA,EAAI;IA7BS;;;;;;EA+KX,WAAN,MAAA,SAAA;IACE,WAAa,OAAA,QAAA,CAAA,EAAA;;UA+Bb,CAAA,eAAA,CAAA;MA/Bc,IAAC,CAAA;MAAO,IAAC,CAAA;MACrB,IAAC,CAAA,EAAD,GAAM,EAAA,GAAG,QAAA,CAAS,IAAI,CAAC,MAAL,CAAA,CAAA,GAAc,OAAvB,EAAT;;;MAGA,IAAC,CAAA,MAAD,GAAU;MACV,IAAC,CAAA,EAAD,GAAM,IAAI;MACV,IAAC,CAAA,EAAD,GAAM,IAAI,YAAJ,CAAiB,IAAjB;MACN,IAAC,CAAA,EAAD,GAAM,IAAI,WAAJ,CAAgB,IAAhB;MACN,IAAC,CAAA,EAAD,GAAM,IAAI,UAAJ,CAAe,IAAf;MACN,IAAC,CAAA,EAAD,GAAM,IAAI,MAAJ,CAAW,IAAX;MACN,IAAC,CAAA,EAAD,GAAM,IAAI,KAAJ,CAAU,IAAV;IAVK;;IAYb,WAAa,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,CAAA;AACX,UAAA;MAAA,KAAA,GAAQ,IAAI,KAAJ,CAAU,IAAV,EAAY,IAAZ,EAAiB,IAAjB,EAAsB,IAAtB;MACR,IAAC,CAAA,MAAM,CAAC,IAAR,CAAa,KAAb;AACA,aAAO;IAHI;;IAKb,IAAM,CAAC,MAAD,EAAS,EAAT,CAAA;MACJ,IAAI,SAAS,CAAC,MAAV,KAAoB,CAApB,IAAyB,OAAO,MAAP,KAAiB,UAA9C;QACE,EAAA,GAAK;QACL,MAAA,GAAS,IAAC,CAAA,KAAD,GAAS,GAAT,GAAe,IAAC,CAAA,MAF3B;;aAIA,IAAC,CAAA,QAAD,CAAU,QAAA,CAAC,GAAD,EAAM,GAAN,CAAA;AACR,YAAA;QAAA,MAAA,GAAS;eACT,MAAA,GAAS,GAAG,CAAC,aAAJ,CAAkB;UAAE,IAAA,EAAM;QAAR,CAAlB,CAAyC,CAAC,IAA1C,CAA+C,QAAA,CAAC,MAAD,CAAA;UACtD,IAAG,GAAH;AACE,mBAAO,EAAA,CAAG,GAAH,EADT;;iBAEA,OAAA,CAAQ,IAAR,CAAa,CAAC,SAAd,CAAwB,MAAxB,EAAgC,MAAhC,EAAwC,EAAxC;QAHsD,CAA/C;MAFD,CAAV;IALI;;IAcN,QAAU,CAAC,EAAD,CAAA;AAER,UAAA,CAAA,EAAA,GAAA,EAAA,CAAA,EAAA,GAAA,EAAA;MAAA,GAAA,GAAM,IAAI,KAAJ,CAAA;MAEN,KAAA,aAAA;QACE,GAAG,CAAC,IAAJ,CAAS,GAAT,EAAc,MAAO,CAAA,GAAA,CAArB;MADF,CAFA;;MAMA,GAAG,CAAC,IAAJ,CAAS,qBAAT,EAA+B,IAAC,CAAA,EAAE,CAAC,KAAJ,CAAA,CAA/B,EANA;;MAQA,GAAG,CAAC,IAAJ,CAAS,kBAAT,EAA4B,IAAC,CAAA,EAAE,CAAC,KAAJ,CAAA,CAA5B,EARA;;MAUA,GAAG,CAAC,IAAJ,CAAS,iBAAT,EAA2B,IAAC,CAAA,EAAE,CAAC,KAAJ,CAAA,CAA3B,EAVA;;MAYA,GAAG,CAAC,IAAJ,CAAS,sBAAT,EAAgC,IAAC,CAAA,EAAE,CAAC,KAAJ,CAAA,CAAhC,EAZA;;MAcA,GAAG,CAAC,IAAJ,CAAS,4BAAT,EAAsC,IAAC,CAAA,EAAE,CAAC,KAAJ,CAAA,CAAtC,EAdA;;MAgBA,KAAS,2FAAT;QACE,GAAG,CAAC,IAAJ,CAAS,qBAAA,GAAsB,CAAC,CAAA,GAAE,CAAH,CAAtB,GAA4B,MAArC,EAA4C,IAAC,CAAA,MAAO,CAAA,CAAA,CAAE,CAAC,KAAX,CAAA,CAA5C;MADF,CAhBA;;MAmBA,GAAG,CAAC,IAAJ,CAAS,eAAT,EAAyB,IAAC,CAAA,EAAE,CAAC,KAAJ,CAAA,CAAzB;aACA,EAAA,CAAG,IAAH,EAAS,GAAT;IAtBQ;;IAwBV,MAAQ,CAAA,CAAA,EAAA;;aAEN,OAAO,CAAC,KAAR,CAAc,iCAAd;IAFM;;EAxDV;;EA4DA,aAAA,GAAgB,QAAA,CAAC,EAAD,CAAA;WACd,EAAE,CAAC,OAAH,CAAA,CAAA,GAAe,QAAf,GAA0B;EADZ;;EAGhB,IAAI,kDAAA,IAAW,wBAAf;IACE,MAAM,CAAC,OAAP,GACE;MAAA,cAAA,EAAgB,QAAA,CAAC,KAAD,EAAQ,KAAR,CAAA;AACd,eAAO,IAAI,QAAJ,CAAa,KAAb,EAAoB,KAApB;MADO;IAAhB,EAFJ;;;EAKA,IAAG,CAAC,gDAAD,CAAH;IACE,MAAM,CAAC,YAAP,GACE;MAAA,cAAA,EAAgB,QAAA,CAAC,KAAD,EAAQ,KAAR,CAAA;AACd,eAAO,IAAI,QAAJ,CAAa,KAAb,EAAoB,KAApB;MADO;IAAhB,EAFJ;GAzfA;;;EA+fA,MAAA,GACE;IAAA,aAAA,EAAe,4kBAAf;IACA,mBAAA,EAAoB,8lBADpB;IAEA,qBAAA,EAAsB,4wNAFtB;IAGA,eAAA,EAAgB;EAHhB;AAhgBF",
  "sourcesContent": [
    "###\n  MS Excel 2007 Creameater v0.0.1\n  Author : chuanyi.zheng@gmail.com\n  History: 2012/11/07 first created\n###\nif (window? && window.JSZip?)\n  JSZip = window.JSZip\nelse if (typeof require != 'undefined' )\n  JSZip = require 'jszip'\nelse\n  throw (\"JSZip not defined\")\n\nif (window? && window.xmlbuilder?)\n  xml = window.xmlbuilder\nelse if (typeof require != 'undefined')\n  xml = require 'xmlbuilder'\nelse\n  throw (\"xmlbuilder not defined\")\n\n####tool =\n#  i2a : (i) ->\n#    return 'ABCDEFGHIJKLMNOPQ###RSTUVWXYZ123'.charAt(i-1)\n\ntool =\n  i2a: (column) ->\n    temp = undefined\n    letter = ''\n    while column > 0\n      temp = (column - 1) % 26\n      letter = String.fromCharCode(temp + 65) + letter\n      column = (column - temp - 1) / 26\n    return letter\n\n\nclass ContentTypes\n  constructor: (@book)->\n\n  toxml:()->\n    types = xml.create('Types',{version:'1.0',encoding:'UTF-8',standalone:true})\n    types.att('xmlns','http://schemas.openxmlformats.org/package/2006/content-types')\n    types.ele('Override',{PartName:'/xl/theme/theme1.xml',ContentType:'application/vnd.openxmlformats-officedocument.theme+xml'})\n    types.ele('Override',{PartName:'/xl/styles.xml',ContentType:'application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml'})\n    types.ele('Default',{Extension:'rels',ContentType:'application/vnd.openxmlformats-package.relationships+xml'})\n    types.ele('Default',{Extension:'xml',ContentType:'application/xml'})\n    types.ele('Override',{PartName:'/xl/workbook.xml',ContentType:'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml'})\n    types.ele('Override',{PartName:'/docProps/app.xml',ContentType:'application/vnd.openxmlformats-officedocument.extended-properties+xml'})\n    for i in [1..@book.sheets.length]\n      types.ele('Override',{PartName:'/xl/worksheets/sheet'+i+'.xml',ContentType:'application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml'})\n    types.ele('Override',{PartName:'/xl/sharedStrings.xml',ContentType:'application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml'})\n    types.ele('Override',{PartName:'/docProps/core.xml',ContentType:'application/vnd.openxmlformats-package.core-properties+xml'})\n    return types.end()\n\nclass DocPropsApp\n  constructor: (@book)->\n\n  toxml: ()->\n    props = xml.create('Properties',{version:'1.0',encoding:'UTF-8',standalone:true})\n    props.att('xmlns','http://schemas.openxmlformats.org/officeDocument/2006/extended-properties')\n    props.att('xmlns:vt','http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes')\n    props.ele('Application','Microsoft Excel')\n    props.ele('DocSecurity','0')\n    props.ele('ScaleCrop','false')\n    tmp = props.ele('HeadingPairs').ele('vt:vector',{size:2,baseType:'variant'})\n    tmp.ele('vt:variant').ele('vt:lpstr','工作表')\n    tmp.ele('vt:variant').ele('vt:i4',''+@book.sheets.length)\n    tmp = props.ele('TitlesOfParts').ele('vt:vector',{size:@book.sheets.length,baseType:'lpstr'})\n    for i in [1..@book.sheets.length]\n      tmp.ele('vt:lpstr',@book.sheets[i-1].name)\n    props.ele('Company')\n    props.ele('LinksUpToDate','false')\n    props.ele('SharedDoc','false')\n    props.ele('HyperlinksChanged','false')\n    props.ele('AppVersion','12.0000')\n    return props.end()\n\nclass XlWorkbook\n  constructor: (@book)->\n\n  toxml: ()->\n    wb = xml.create('workbook',{version:'1.0',encoding:'UTF-8',standalone:true})\n    wb.att('xmlns','http://schemas.openxmlformats.org/spreadsheetml/2006/main')\n    wb.att('xmlns:r','http://schemas.openxmlformats.org/officeDocument/2006/relationships')\n    wb.ele('fileVersion ',{appName:'xl',lastEdited:'4',lowestEdited:'4',rupBuild:'4505'})\n    wb.ele('workbookPr',{filterPrivacy:'1',defaultThemeVersion:'124226'})\n    wb.ele('bookViews').ele('workbookView ',{xWindow:'0',yWindow:'90',windowWidth:'19200',windowHeight:'11640'})\n    tmp = wb.ele('sheets')\n    for i in [1..@book.sheets.length]\n      tmp.ele('sheet',{name:@book.sheets[i-1].name,sheetId:''+i,'r:id':'rId'+i})\n\n\n    definedNames = wb.ele('definedNames') # one entry per autofilter\n    @book.sheets.forEach((sheet, idx) ->\n      if (sheet.autofilter)\n        definedNames.ele('definedName', {name: '_xlnm._FilterDatabase', hidden: '1', localSheetId: idx}).raw(\"'\"+sheet.name + \"'!\"  + sheet.getRange())\n    )\n    wb.ele('calcPr',{calcId:'124519'})\n    return wb.end()\n\nclass XlRels\n  constructor: (@book)->\n\n  toxml: ()->\n    rs = xml.create('Relationships',{version:'1.0',encoding:'UTF-8',standalone:true})\n    rs.att('xmlns','http://schemas.openxmlformats.org/package/2006/relationships')\n    for i in [1..@book.sheets.length]\n      rs.ele('Relationship',{Id:'rId'+i,Type:'http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet',Target:'worksheets/sheet'+i+'.xml'})\n    rs.ele('Relationship',{Id:'rId'+(@book.sheets.length+1),Type:'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme',Target:'theme/theme1.xml'})\n    rs.ele('Relationship',{Id:'rId'+(@book.sheets.length+2),Type:'http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles',Target:'styles.xml'})\n    rs.ele('Relationship',{Id:'rId'+(@book.sheets.length+3),Type:'http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings',Target:'sharedStrings.xml'})\n    return rs.end()\n\nclass SharedStrings\n  constructor: ()->\n    @cache = {}\n    @arr = []\n\n  str2id: (s)->\n    id = @cache[s]\n    if id\n      return id\n    else\n      @arr.push s\n      @cache[s] = @arr.length\n      return @arr.length\n\n  toxml: ()->\n    sst = xml.create('sst',{version:'1.0',encoding:'UTF-8',standalone:true})\n    sst.att('xmlns','http://schemas.openxmlformats.org/spreadsheetml/2006/main')\n    sst.att('count',''+@arr.length)\n    sst.att('uniqueCount',''+@arr.length)\n    for i in [0...@arr.length]\n      si = sst.ele('si')\n      si.ele('t',@arr[i])\n      si.ele('phoneticPr',{fontId:1,type:'noConversion'})\n    return sst.end()\n\nclass Sheet\n  constructor: (@book, @name, @cols, @rows) ->\n    @name = @name.replace(/[/*:?\\[\\]]/g,'-');\n\n\n    @data = {}\n    for i in [1..@rows]\n      @data[i] = {}\n      for j in [1..@cols]\n        @data[i][j] = {v:0}\n    @merges = []\n    @col_wd = []\n    @row_ht = {}\n    @styles = {}\n    \n\n  set: (col, row, str) ->\n    if str instanceof Date\n      @set col, row, JSDateToExcel str\n      # for some reason the number format doesn't apply if the fill is not also set. BUG? Mystery?\n      @fill col, row,\n        type: \"solid\",\n        fgColor: \"FFFFFF\"\n      @numberFormat col, row, 'd-mmm'\n    else if typeof str == 'object'\n      for key of str\n        @[key] col, row, str[key]\n    else if  typeof str == 'string'\n      if str != null and str != ''\n        @data[row][col].v = @book.ss.str2id('' + str)\n      return @data[row][col].dataType = 'string'\n    else if typeof str == 'number'\n      @data[row][col].v = str\n      return @data[row][col].dataType = 'number'\n    else\n      @data[row][col].v = str\n    return\n\n  merge: (from_cell, to_cell) ->\n    @merges.push({from:from_cell, to:to_cell})\n\n  width: (col, wd) ->\n    @col_wd.push {c:col,cw:wd}\n\n  height: (row, ht) ->\n    @row_ht[row] = ht\n\n  font: (col, row, font_s)->\n    @styles['font_'+col+'_'+row] = @book.st.font2id(font_s)\n\n  fill: (col, row, fill_s)->\n    @styles['fill_'+col+'_'+row] = @book.st.fill2id(fill_s)\n\n  border: (col, row, bder_s)->\n    @styles['bder_'+col+'_'+row] = @book.st.bder2id(bder_s)\n\n  numberFormat: (col, row, numfmt_s)->\n    @styles['numfmt_'+col+'_'+row] = @book.st.numfmt2id(numfmt_s)\n\n  align: (col, row, align_s)->\n    @styles['algn_'+col+'_'+row] = align_s\n\n  valign: (col, row, valign_s)->\n    @styles['valgn_'+col+'_'+row] = valign_s\n\n  rotate: (col, row, textRotation)->\n    @styles['rotate_'+col+'_'+row] = textRotation\n\n  wrap: (col, row, wrap_s)->\n    @styles['wrap_'+col+'_'+row] = wrap_s\n\n  autoFilter: ( filter_s) ->\n    @autofilter = if typeof filter_s == 'string' then filter_s else @getRange()\n    \n  style_id: (col, row) ->\n    inx = '_'+col+'_'+row\n    style = {numfmt_id: @styles['numfmt'+inx],font_id:@styles['font'+inx],fill_id:@styles['fill'+inx],bder_id:@styles['bder'+inx],align:@styles['algn'+inx],valign:@styles['valgn'+inx],rotate:@styles['rotate'+inx],wrap:@styles['wrap'+inx]}\n    id = @book.st.style2id(style)\n    return  id\n\n  getRange: () ->\n    return '$A$1:$'+ tool.i2a(@cols)+'$'+@rows\n\n  toxml: () ->\n    ws = xml.create('worksheet',{version:'1.0',encoding:'UTF-8',standalone:true})\n    ws.att('xmlns','http://schemas.openxmlformats.org/spreadsheetml/2006/main')\n    ws.att('xmlns:r','http://schemas.openxmlformats.org/officeDocument/2006/relationships')\n    ws.ele('dimension',{ref:'A1'})\n    ws.ele('sheetViews').ele('sheetView',{workbookViewId:'0'})\n    ws.ele('sheetFormatPr',{defaultRowHeight:'13.5'})\n    if @col_wd.length > 0\n      cols = ws.ele('cols')\n      for cw in @col_wd\n        cols.ele('col',{min:''+cw.c,max:''+cw.c,width:cw.cw,customWidth:'1'})\n    sd = ws.ele('sheetData')\n    for i in [1..@rows]\n      r = sd.ele('row',{r:''+i,spans:'1:'+@cols})\n      ht = @row_ht[i]\n      if ht\n        r.att('ht',ht)\n        r.att('customHeight','1')\n      for j in [1..@cols]\n        ix = @data[i][j]\n        sid = @style_id(j, i)\n        if (ix.v isnt null and ix.v isnt undefined) or (sid isnt 1)\n          c = r.ele('c',{r:''+tool.i2a(j)+i})\n          c.att('s',''+(sid-1)) if sid isnt 1\n          if ix.dataType == 'string'\n            c.att('t','s')\n            c.ele('v',''+(ix.v-1))\n          else if ix.dataType == 'number'\n            c.ele 'v', ''+ix.v\n\n    if @merges.length > 0\n      mc = ws.ele('mergeCells',{count:@merges.length})\n      for m in @merges\n        mc.ele('mergeCell',{ref:(''+tool.i2a(m.from.col)+m.from.row+':'+tool.i2a(m.to.col)+m.to.row)})\n    if typeof @autofilter == 'string'\n      ws.ele('autoFilter', {ref: @autofilter})\n    ws.ele('phoneticPr',{fontId:'1',type:'noConversion'})\n    ws.ele('pageMargins',{left:'0.7',right:'0.7',top:'0.75',bottom:'0.75',header:'0.3',footer:'0.3'})\n    ws.ele('pageSetup',{paperSize:'9',orientation:'portrait',horizontalDpi:'200',verticalDpi:'200'})\n    return ws.end()\n\nclass Style\n\n  numberFormats: {\n    0: 'General'\n    1: '0'\n    2: '0.00'\n    3: '#,##0'\n    4: '#,##0.00'\n    9: '0%'\n    10: '0.00%'\n    11: '0.00E+00'\n    12: '# ?/?'\n    13: '# ??/??'\n    14: 'm/d/yy'\n    15: 'd-mmm-yy'\n    16: 'd-mmm'\n    17: 'mmm-yy'\n    18: 'h:mm AM/PM'\n    19: 'h:mm:ss AM/PM'\n    20: 'h:mm'\n    21: 'h:mm:ss'\n    22: 'm/d/yy h:mm'\n    37: '#,##0 ;(#,##0)'\n    38: '#,##0 ;[Red](#,##0)'\n    39: '#,##0.00;(#,##0.00)'\n    40: '#,##0.00;[Red](#,##0.00)'\n    45: 'mm:ss'\n    46: '[h]:mm:ss'\n    47: 'mmss.0'\n    48: '##0.0E+0'\n    49: '@'\n    56: '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"'\n  }\n\n\n  constructor: (@book)->\n    @cache = {}\n    @mfonts = []  # font style\n    @mfills = []  # fill style\n    @mbders = []  # border style\n    @mstyle = []  # cell style<ref-font,ref-fill,ref-border,align>\n    @with_default()\n\n  with_default:()->\n    @def_font_id = @font2id(null)\n    @def_fill_id = @fill2id(null)\n    @def_bder_id = @bder2id(null)\n    @def_align = '-'\n    @def_valign = '-'\n    @def_rotate = '-'\n    @def_wrap = '-'\n    @def_style_id = @style2id({font_id:@def_font_id,fill_id:@def_fill_id,bder_id:@def_bder_id,align:@def_align,valign:@def_valign,rotate:@def_rotate})\n\n  font2id: (font)->\n    font or= {}\n    font.bold or= '-'\n    font.iter or= '-'\n    font.sz or= '11'\n    font.color or= '-'\n    font.name or= '宋体'\n    font.scheme or='minor'\n    font.family or= '2'\n    k = 'font_'+font.bold+font.iter+font.sz+font.color+font.name+font.scheme+font.family\n    id = @cache[k]\n    if id\n      return id\n    else\n      @mfonts.push font\n      @cache[k] = @mfonts.length\n      return @mfonts.length\n\n  fill2id: (fill)->\n    fill or= {}\n    fill.type or= 'none'\n    fill.bgColor or= '-'\n    fill.fgColor or= '-'\n    k = 'fill_' + fill.type + fill.bgColor + fill.fgColor\n    id = @cache[k]\n    if id\n      return id\n    else\n      @mfills.push fill\n      @cache[k] = @mfills.length\n      return @mfills.length\n\n  bder2id: (bder)->\n    bder or= {}\n    bder.left or= '-'\n    bder.right or= '-'\n    bder.top or= '-'\n    bder.bottom or= '-'\n    k = 'bder_'+bder.left+'_'+bder.right+'_'+bder.top+'_'+bder.bottom\n    id = @cache[k]\n    if id\n      return id\n    else\n      @mbders.push bder\n      @cache[k] = @mbders.length\n      return @mbders.length\n\n  numfmt2id: (numfmt) ->\n    if typeof numfmt == 'number'\n      return numfmt\n    else if typeof numfmt == 'string'\n      for key of @numberFormats\n        if @numberFormats[key] == numfmt\n          return key;\n\n      throw \"Number format \"+numfmt + \" not found.  Custom number formats not implemented yet\"\n\n  style2id:(style)->\n    style.align or= @def_align\n    style.valign or= @def_valign\n    style.rotate or= @def_rotate\n    style.wrap or= @def_wrap\n    style.font_id or= @def_font_id\n    style.fill_id or= @def_fill_id\n    style.bder_id or= @def_bder_id\n    k = 's_' + style.font_id + '_' + style.fill_id + '_' + style.bder_id + '_' + style.align + '_' + style.valign + '_' + style.wrap + '_' + style.rotate\n    id = @cache[k]\n    if id\n      return id\n    else\n      @mstyle.push style\n      @cache[k] = @mstyle.length\n      return @mstyle.length\n\n  toxml: ()->\n    ss = xml.create('styleSheet',{version:'1.0',encoding:'UTF-8',standalone:true})\n    ss.att('xmlns','http://schemas.openxmlformats.org/spreadsheetml/2006/main')\n    fonts = ss.ele('fonts',{count:@mfonts.length})\n    for o in @mfonts\n      e = fonts.ele('font')\n      e.ele('b') if o.bold isnt '-'\n      e.ele('i') if o.iter isnt '-'\n      e.ele('sz',{val:o.sz})\n      e.ele('color',{rgb:o.color}) if o.color isnt '-'\n      e.ele('name',{val:o.name})\n      e.ele('family',{val:o.family})\n      e.ele('charset',{val:'134'})\n      e.ele('scheme',{val:'minor'}) if o.scheme isnt '-'\n    fills = ss.ele('fills',{count:@mfills.length+2})\n    fills.ele('fill').ele('patternFill', {patternType: 'none'})\n    fills.ele('fill').ele('patternFill', {patternType: 'gray125'})\n    #<fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill>\n\n    for o in @mfills\n      e = fills.ele('fill')\n      es = e.ele('patternFill',{patternType:o.type})\n      es.ele('fgColor',{rgb : o.fgColor}) if o.fgColor isnt '-'\n      es.ele('bgColor',{indexed:o.bgColor}) if o.bgColor isnt '-'\n    bders = ss.ele('borders',{count:@mbders.length})\n    for o in @mbders\n\n      e = bders.ele('border')\n      if o.left isnt '-' then e.ele('left',{style:o.left}).ele('color',{auto:'1'}) else e.ele('left')\n      if o.right isnt '-' then e.ele('right',{style:o.right}).ele('color',{auto:'1'}) else e.ele('right')\n      if o.top isnt '-' then e.ele('top',{style:o.top}).ele('color',{auto:'1'}) else e.ele('top')\n      if o.bottom isnt '-' then e.ele('bottom',{style:o.bottom}).ele('color',{auto:'1'}) else e.ele('bottom')\n      e.ele('diagonal')\n    ss.ele('cellStyleXfs',{count:'1'}).ele('xf',{numFmtId:'0',fontId:'0',fillId:'0',borderId:'0'}).ele('alignment',{vertical:'center'})\n    cs = ss.ele('cellXfs',{count:@mstyle.length})\n    for o in @mstyle\n      e = cs.ele('xf',{numFmtId: o.numfmt_id||'0',fontId:(o.font_id-1),fillId:o.fill_id+1,borderId:(o.bder_id-1),xfId:'0'})\n      e.att('applyFont','1') if o.font_id isnt 1\n      e.att('applyFill','1') if o.fill_id isnt 1\n      e.att('applyNumberFormat','1') if o.numfmt_id isnt undefined\n      e.att('applyBorder','1') if o.bder_id isnt 1\n      if o.align isnt '-' or o.valign isnt '-' or o.wrap isnt '-'\n        e.att('applyAlignment','1')\n        ea = e.ele('alignment',{textRotation:(if o.rotate is '-' then '0' else o.rotate),horizontal:(if o.align is '-' then 'left' else o.align), vertical:(if o.valign is '-' then 'top' else o.valign)})\n        ea.att('wrapText','1') if o.wrap isnt '-'\n    ss.ele('cellStyles',{count:'1'}).ele('cellStyle',{name:'常规',xfId:'0',builtinId:'0'})\n    ss.ele('dxfs',{count:'0'})\n    ss.ele('tableStyles',{count:'0',defaultTableStyle:'TableStyleMedium9',defaultPivotStyle:'PivotStyleLight16'})\n    return ss.end()\n\nclass Workbook\n  constructor: (@fpath, @fname) ->\n    @id = ''+parseInt(Math.random()*9999999)\n    # create temp folder & copy template data\n    # init\n    @sheets = []\n    @ss = new SharedStrings\n    @ct = new ContentTypes(@)\n    @da = new DocPropsApp(@)\n    @wb = new XlWorkbook(@)\n    @re = new XlRels(@)\n    @st = new Style(@)\n\n  createSheet: (name, cols, rows) ->\n    sheet = new Sheet(@,name,cols,rows)\n    @sheets.push sheet\n    return sheet\n\n  save: (target, cb) ->\n    if (arguments.length == 1 && typeof target == 'function')\n      cb = target\n      target = @fpath + '/' + @fname\n\n    @generate (err, zip) ->\n      buffer = undefined\n      buffer = zip.generateAsync({ type: 'nodebuffer' }).then((buffer) ->\n        if err\n          return cb(err)\n        require('fs').writeFile target, buffer, cb\n      )\n\n  # takes a callback function(err, zip) and returns a JSZip object on success\n  generate: (cb) =>\n\n    zip = new JSZip()\n\n    for key of baseXl\n      zip.file key, baseXl[key]\n\n    # 1 - build [Content_Types].xml\n    zip.file('[Content_Types].xml',@ct.toxml())\n    # 2 - build docProps/app.xml\n    zip.file('docProps/app.xml',@da.toxml())\n    # 3 - build xl/workbook.xml\n    zip.file('xl/workbook.xml',@wb.toxml())\n    # 4 - build xl/sharedStrings.xml\n    zip.file('xl/sharedStrings.xml',@ss.toxml())\n    # 5 - build xl/_rels/workbook.xml.rels\n    zip.file('xl/_rels/workbook.xml.rels',@re.toxml())\n    # 6 - build xl/worksheets/sheet(1-N).xml\n    for i in [0...@sheets.length]\n      zip.file('xl/worksheets/sheet'+(i+1)+'.xml',@sheets[i].toxml())\n    # 7 - build xl/styles.xml\n    zip.file('xl/styles.xml',@st.toxml())\n    cb null, zip\n\n  cancel: () ->\n    # delete temp folder\n    console.error \"workbook.cancel() is deprecated\"\n\nJSDateToExcel = (dt) ->\n  dt.valueOf() / 86400000 + 25569\n\nif (module? && module.exports?)\n  module.exports =\n    createWorkbook: (fpath, fname)->\n      return new Workbook(fpath, fname)\n\nif (window?)\n  window.excelbuilder =\n    createWorkbook: (fpath, fname)->\n      return new Workbook(fpath, fname)\n\n# Base content formerly stored in /lib/tmpl but placed in code so as to avoid dependence on file system\nbaseXl =\n  '_rels/.rels': '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\"><Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\" Target=\"docProps/app.xml\"/><Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\" Target=\"docProps/core.xml\"/><Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/></Relationships>'\n  'docProps/core.xml':'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><cp:coreProperties xmlns:cp=\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:dcterms=\"http://purl.org/dc/terms/\" xmlns:dcmitype=\"http://purl.org/dc/dcmitype/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"><dc:creator>Administrator</dc:creator><cp:lastModifiedBy></cp:lastModifiedBy><dcterms:created xsi:type=\"dcterms:W3CDTF\">2006-09-13T11:21:51Z</dcterms:created><dcterms:modified xsi:type=\"dcterms:W3CDTF\">2006-09-13T11:21:55Z</dcterms:modified></cp:coreProperties>'\n  'xl/theme/theme1.xml':'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office 主题\"><a:themeElements><a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2><a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5><a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Cambria\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/></a:majorFont><a:minorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:shade val=\"51000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"80000\"><a:schemeClr val=\"phClr\"><a:shade val=\"93000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"94000\"/><a:satMod val=\"135000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/></a:theme>'\n  'xl/styles.xml':'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"><fonts count=\"2\"><font><sz val=\"11\"/><color theme=\"1\"/><name val=\"宋体\"/><family val=\"2\"/><charset val=\"134\"/><scheme val=\"minor\"/></font><font><sz val=\"9\"/><name val=\"宋体\"/><family val=\"2\"/><charset val=\"134\"/><scheme val=\"minor\"/></font></fonts><fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills><borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders><cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"><alignment vertical=\"center\"/></xf></cellStyleXfs><cellXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" xfId=\"0\"><alignment vertical=\"center\"/></xf></cellXfs><cellStyles count=\"1\"><cellStyle name=\"常规\" xfId=\"0\" builtinId=\"0\"/></cellStyles><dxfs count=\"0\"/><tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleLight16\"/></styleSheet>'"
  ]
}